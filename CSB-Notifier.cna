# CS Beacon Notifier
# A Cobalt Strike Beacon Notifier Via Telegram Bot
# Author @lynxbinz / Vasco0x4

# Path to Python script
$pyScript = "pyScript.py";

on beacon_initial {
    # Collect beacon information
    $userName = beacon_info($1, "user");
    $computerName = beacon_info($1, "computer");
    $operatingSystem = beacon_info($1, "os");
    $architecture = beacon_info($1, "arch");
    $buildVersion = beacon_info($1, "build");
    $inIP = beacon_info($1, "internal");
    $exIP = beacon_info($1, "external");
    $processName = beacon_info($1, "process");
    $timestamp = formatDate("yyyy-MM-dd HH:mm:ss");

    # Format notification message
    $notification = "ğŸ¯ New Beacon Alert | $timestamp

ğŸ” System Details:
------------------------
ğŸ‘¤ User: $userName
ğŸ’» Hostname: $computerName
ğŸ–¥ï¸ OS: $operatingSystem $architecture
ğŸ—ï¸ Build: $buildVersion
âš™ï¸ Process: $processName

ğŸŒ Network:
------------------------
ğŸ  Internal IP: $inIP
ğŸŒ External IP: $exIP
------------------------";

    # Execute Python script with notification
    @command = @('python3', $pyScript, $notification);
    exec(@command);
}

